<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Infrastructure-Playbook/blog/rss.xml" title="Hackney Infrastructure Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Infrastructure-Playbook/blog/atom.xml" title="Hackney Infrastructure Playbook Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Infrastructure Playbook" href="/Infrastructure-Playbook/opensearch.xml"><title data-react-helmet="true">Application Logging Guidelines | Hackney Infrastructure Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Application Logging Guidelines | Hackney Infrastructure Playbook"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><meta data-react-helmet="true" property="og:url" content="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/application_logging"><link data-react-helmet="true" rel="shortcut icon" href="/Infrastructure-Playbook/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/application_logging"><link rel="stylesheet" href="/Infrastructure-Playbook/styles.2116970b.css">
<link rel="stylesheet" href="/Infrastructure-Playbook/main.4a16e2e4.css">
<link rel="preload" href="/Infrastructure-Playbook/styles.7299e51b.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/runtime~main.58b5ab71.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/main.5b7a4e19.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/1.e9c46241.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/2.316fd6e7.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/65.f167685d.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/68.c087ac3c.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/935f2afb.7c354906.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/17896441.40891053.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/bc1ec4d6.5d7fe3a7.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Application Logging Guidelines</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>This document defines a set of guidelines used to produce rich application logging for applications belonging to a microservice architecture.
Providing rich logging information will make it easier to investigate issues without making use of intrusive approaches (i.e: debug, memory dump), also making visible the behaviour of services by using monitoring tools to extract and/or query these logs.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="categories"></a>Categories<a class="hash-link" href="#categories" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="application"></a>Application<a class="hash-link" href="#application" title="Direct link to heading">#</a></h3><p>Logs related to the application behaviour that does not result into exceptions and would not be visible externally if not logged. Common scenarios are conditional behaviours that will generate different outputs based on the contents of the command or state of the resource being manipulated. Application logs should be the only log level required within the application and must be used with caution to avoid excessive log entries without value for issues investigation.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="events"></a>Events<a class="hash-link" href="#events" title="Direct link to heading">#</a></h3><p>Events are application notifications used to inform external components that an activity has happened within the application. In some cases the event will let external subscribers know if an operation happened successfully or failed. Every operation will raise at least two types of events, success or failure, but in some cases, it might generate different events based on the context of the operation. All events raised by an application are logged by the infrastructure components, so adding a log information to notify an event has happened is not required and will make the logging redundant.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="exceptions"></a>Exceptions<a class="hash-link" href="#exceptions" title="Direct link to heading">#</a></h3><p>Exceptions is an execution flow mechanism used to interrupt the current processing flow either because, the application or one of itâ€™s dependent components behaved unexpectedly and canâ€™t proceed, or an application logic is aware it canâ€™t proceed because doing so will/may cause issues. All exceptions raised by an application or itâ€™s dependencies are logged by the infrastructure components, so adding a log information to notify an exception has happened is not required and will make the logging redundant.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tracing-and-context-correlation"></a>Tracing and Context Correlation<a class="hash-link" href="#tracing-and-context-correlation" title="Direct link to heading">#</a></h3><p>Whether an application executes a task successfully or not is often highly dependent on the input from the user. As a result, this contextual information may be vital when trying to diagnose a fault.</p><p>This can be achieved by setting a property of your logging platform during the startup of a component.
This allows to view the unified stream of &quot;events&quot;, but also to segregate per role when required to troubleshoot an individual component.
Every operation in an application is initiated by a trigger either externally or internally (synchronous processing). In general, these triggers do not have visibility of the behaviour for each service, and just expect a result as output from a request.
In many cases, these operations may trigger operations into dependent services to accomplish the initial operation. These chain of events need to be correlated in order to identify possible failures or for auditing purposes. For this reason, enter into scene the CorrelationId and TracingContext.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="correlation-id"></a>Correlation Id<a class="hash-link" href="#correlation-id" title="Direct link to heading">#</a></h2><p>In order to identify any operation executed across different components and layers but that are part of the same context, there should be a correlationId sent from the client triggering the operation.
CorrelationId is a global unique identifier (GUID) attribute provided by callers (or auto-generated when one is not provided) to identify the chain of calls between services.
For instance, an HTTP client should send a correlationId header for every call. The downstream systems should pass along this correlationId to any downstream layer so that all traces/logs can be identified as part of the same operation.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="tracing-context"></a>Tracing Context<a class="hash-link" href="#tracing-context" title="Direct link to heading">#</a></h3><p>Tracing Context is the name given to the correlated chain of calls that happened from an initial trigger until it reached the current state. By default the Tracing Context will be using the CorrelationId to identify all events raised since the first trigger initiate the operation.
Currently, the correlation identify the events in a chronological order and events happening in parallel on separate services will be mixed up.</p><p><strong> Additional Attributes to Consider (Custom Dimensions) </strong></p><table><thead><tr><th>Attribute Name</th><th>Attribute Name</th><th>Attribute Name</th><th>Attribute Name</th></tr></thead><tbody><tr><td>Domain *</td><td>Application Instance</td><td>tenure</td><td>Domain name which the service belongs to</td></tr><tr><td>Service *</td><td>Application Instance</td><td>tenure-listener / tenure-api</td><td>The service name generating the logs</td></tr><tr><td>Environment *</td><td>Application Instance</td><td>dev</td><td>Environment name</td></tr><tr><td>Version *</td><td>Application Instance</td><td>1.2.345</td><td>Semantic Version Number</td></tr><tr><td>CorrelationId *</td><td>Per Operation</td><td>3fa85f64-5717-4562-b3fc-2c963f-66afa6</td><td>Id used to chain events and logs executed by multiple operations</td></tr><tr><td>OperationId</td><td>Per Operation</td><td>3fa85f64-5717-4562-b3fc-2c963f-66afa6</td><td>Unique Id that identifies one occurrence of the operation i.e: Requestid</td></tr><tr><td>OperationName</td><td>Per Operation</td><td>Update Tenure</td><td>Name of operation being executed</td></tr><tr><td>UserId</td><td>Per Operation</td><td>KJS827HJS88S</td><td>Id of user triggering the operation</td></tr><tr><td>Logger(SourceContext)</td><td>Per Log Entry</td><td>Company.Solution.ClassName</td><td>Name of component or class generating the logs.</td></tr><tr><td>ResourceId</td><td>Per Log Entry</td><td>tenure-12345</td><td>When an operation is being executred in the context of an existing resource (i.e. a repair) the logs should make the id of the order being modified available.</td></tr></tbody></table><p><strong> NOTE: </strong>
Attributes marked with a * indicate <em>high importance</em>.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="scopes"></a>Scopes<a class="hash-link" href="#scopes" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="application-instance"></a>Application Instance<a class="hash-link" href="#application-instance" title="Direct link to heading">#</a></h3><p>Each deployed instance of an application will provide the same log attributes to all log entries generated. It does not change in the scope of the operations generating
the logs.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="per-operation"></a>Per Operation<a class="hash-link" href="#per-operation" title="Direct link to heading">#</a></h3><p>When an operation is started (API request, message from a Queue), the attributes will be set and used throughout the chain of calls using the same attributes. It does not change based on the context within the application. In case the value does not come from external calls, should be generated internally.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="per-log-entry"></a>Per Log Entry<a class="hash-link" href="#per-log-entry" title="Direct link to heading">#</a></h3><p>Each class or logger will have itâ€™s own set of attributes used within itâ€™s context to identify the source component that is generating the logs. i.e: The class name writing to the logs, the Resource Id being manipulated, or any data available only in the context of the logger.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="filters-and-masking"></a>Filters and Masking<a class="hash-link" href="#filters-and-masking" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="filters"></a>Filters<a class="hash-link" href="#filters" title="Direct link to heading">#</a></h3><ul><li>To reduce the high volume of log entries, the applications should add the following log filters:</li><li>Filter out healthcheck logs (keep errors)</li><li>Limit the log level to</li><li>Non production environments = Information</li><li>Production environments = Warning</li><li>Don&#x27;t let ASP.NET Core Console Logging Slow your App down</li><li>Logging in .NET Core and ASP.NET Core</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="masking"></a>Masking<a class="hash-link" href="#masking" title="Direct link to heading">#</a></h3><p>Prevent log entries containing Personal Identifiable Information (PII) by removing the attributes, or, masking part of the value.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/application_logging.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#categories" class="table-of-contents__link">Categories</a><ul><li><a href="#application" class="table-of-contents__link">Application</a></li><li><a href="#events" class="table-of-contents__link">Events</a></li><li><a href="#exceptions" class="table-of-contents__link">Exceptions</a></li><li><a href="#tracing-and-context-correlation" class="table-of-contents__link">Tracing and Context Correlation</a></li></ul></li><li><a href="#correlation-id" class="table-of-contents__link">Correlation Id</a><ul><li><a href="#tracing-context" class="table-of-contents__link">Tracing Context</a></li></ul></li><li><a href="#scopes" class="table-of-contents__link">Scopes</a><ul><li><a href="#application-instance" class="table-of-contents__link">Application Instance</a></li><li><a href="#per-operation" class="table-of-contents__link">Per Operation</a></li><li><a href="#per-log-entry" class="table-of-contents__link">Per Log Entry</a></li></ul></li><li><a href="#filters-and-masking" class="table-of-contents__link">Filters and Masking</a><ul><li><a href="#filters" class="table-of-contents__link">Filters</a></li><li><a href="#masking" class="table-of-contents__link">Masking</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Infrastructure-Playbook/styles.7299e51b.js"></script>
<script src="/Infrastructure-Playbook/runtime~main.58b5ab71.js"></script>
<script src="/Infrastructure-Playbook/main.5b7a4e19.js"></script>
<script src="/Infrastructure-Playbook/1.e9c46241.js"></script>
<script src="/Infrastructure-Playbook/2.316fd6e7.js"></script>
<script src="/Infrastructure-Playbook/65.f167685d.js"></script>
<script src="/Infrastructure-Playbook/68.c087ac3c.js"></script>
<script src="/Infrastructure-Playbook/935f2afb.7c354906.js"></script>
<script src="/Infrastructure-Playbook/17896441.40891053.js"></script>
<script src="/Infrastructure-Playbook/bc1ec4d6.5d7fe3a7.js"></script>
</body>
</html>