<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Infrastructure-Playbook/blog/rss.xml" title="Hackney Infrastructure Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Infrastructure-Playbook/blog/atom.xml" title="Hackney Infrastructure Playbook Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Infrastructure Playbook" href="/Infrastructure-Playbook/opensearch.xml"><title data-react-helmet="true">Compatibility | Hackney Infrastructure Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Compatibility | Hackney Infrastructure Playbook"><meta data-react-helmet="true" name="description" content="MUST Maintain Backward Compatibility"><meta data-react-helmet="true" property="og:description" content="MUST Maintain Backward Compatibility"><meta data-react-helmet="true" property="og:url" content="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/compatibility"><link data-react-helmet="true" rel="shortcut icon" href="/Infrastructure-Playbook/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/compatibility"><link rel="stylesheet" href="/Infrastructure-Playbook/styles.2116970b.css">
<link rel="stylesheet" href="/Infrastructure-Playbook/main.4a16e2e4.css">
<link rel="preload" href="/Infrastructure-Playbook/styles.79c14b36.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/runtime~main.9e5678c6.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/main.cce976fb.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/1.70185c52.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/2.547559b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/67.3e59262b.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/70.9338f9b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/935f2afb.1ccafd65.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/17896441.decf34b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/e29b0ef0.f3d10379.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Compatibility</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="must-maintain-backward-compatibility"></a>MUST Maintain Backward Compatibility<a class="hash-link" href="#must-maintain-backward-compatibility" title="Direct link to heading">#</a></h2><p>Change APIs, but keep all consumers running. Consumers usually have independent release lifecycles, focus on stability, and avoid changes that do not provide additional value. APIs are contracts between service providers and service consumers that cannot be broken via unilateral decisions.</p><p>There are two techniques to change APIs without breaking them:</p><ul><li><p>follow rules for compatible extensions</p></li><li><p>introduce new API versions and still support older versions</p></li></ul><p>We strongly encourage using compatible API changes and discourage versioning. The following guidelines for service providers and consumers enable us to make compatible changes without versioning.</p><p><strong>Note:</strong> There is a difference between incompatible and breaking changes. Incompatible changes are changes that are not covered by the compatibility rules below. Breaking changes are incompatible changes deployed into operation, and thereby breaking running API consumers. Usually, incompatible changes are breaking changes when deployed into operation. However, in specific controlled situations it is possible to deploy incompatible changes in a non-breaking way, if no API consumer is using the affected API aspects (see also <a href="/Infrastructure-Playbook/deprecation">Deprecation</a>).</p><p><strong>Hint:</strong> Please note that the compatibility guarantees are for the &quot;on the wire&quot; format. Binary or source compatibility of code generated from an API definition is not covered by these rules. If client implementations update their generation process to a new version of the API definition, it has to be expected that code changes are necessary.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="should-prefer-compatible-changes"></a>SHOULD Prefer Compatible Changes<a class="hash-link" href="#should-prefer-compatible-changes" title="Direct link to heading">#</a></h2><p>API designers should apply the following rules to evolve RESTful APIs for services in a backward-compatible way:</p><ul><li><p>Add only optional, never mandatory fields.</p></li><li><p>Never change the semantics of fields (e.g. changing the semantics from customer-number to customer-id, as both are     different unique customer keys)</p></li><li><p>Input fields may have (complex) constraints being validated via server-side business logic. Never change the validation logic to be more restrictive and make sure that all constraints are clearly defined in description.</p></li><li><p>Support redirection in case an URL has to change (<a href="https://en.wikipedia.org/wiki/HTTP_301" target="_blank" rel="noopener noreferrer">301 Moved Permanently</a>).</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="must-prepare-clients-to-not-crash-on-compatible-api-extensions"></a>MUST Prepare Clients To Not Crash On Compatible API Extensions<a class="hash-link" href="#must-prepare-clients-to-not-crash-on-compatible-api-extensions" title="Direct link to heading">#</a></h2><p>Service clients should apply the robustness principle:</p><ul><li><p>Be conservative with API requests and data passed as input, e.g. avoid to exploit definition deficits like passing megabytes for strings with unspecified maximum length.</p></li><li><p>Be tolerant in processing and reading data of API responses</p></li></ul><p>Service clients must be prepared for compatible API extensions of service providers:</p><ul><li><p>Be tolerant with unknown fields in the payload (see also Fowlerâ€™s <a href="http://martinfowler.com/bliki/TolerantReader.html" target="_blank" rel="noopener noreferrer">&quot;TolerantReader&quot;</a> post), i.e. ignore new fields but do not eliminate them from payload if needed for subsequent PUT requests.</p></li><li><p>Be prepared to handle HTTP status codes not explicitly specified in endpoint definitions. Note also, that status codes are extensible. Default handling is how you would treat the corresponding x00 code (see <a href="https://tools.ietf.org/html/rfc7231#section-6" target="_blank" rel="noopener noreferrer">RFC7231 Section 6</a>).</p></li><li><p>Follow the redirect when the server returns HTTP status <a href="https://en.wikipedia.org/wiki/HTTP_301" target="_blank" rel="noopener noreferrer">301 Moved Permanently</a>.</p></li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="should-design-apis-conservatively"></a>SHOULD Design APIs Conservatively<a class="hash-link" href="#should-design-apis-conservatively" title="Direct link to heading">#</a></h2><p>Designers of service provider APIs should be conservative and accurate in what they accept from clients:</p><ul><li><p>Unknown input fields in payload or URL should not be ignored; servers should provide error feedback to clients via an HTTP 400 response code.</p></li><li><p>Be accurate in defining input data constraints (like formats, ranges, lengths etc.) â€” and check constraints and return dedicated error information in case of violations.</p></li><li><p>Prefer being more specific and restrictive (if compliant to functional requirements), e.g. by defining length range of strings. It may simplify implementation while providing freedom for further evolution as compatible extensions.</p></li></ul><p>Not ignoring unknown input fields is a specific deviation from Postelâ€™s Law (e.g. see also<br>
<a href="https://cacm.acm.org/magazines/2011/8/114933-the-robustness-principle-reconsidered/fulltext" target="_blank" rel="noopener noreferrer">The Robustness Principle Reconsidered</a>) and a strong recommendation. Servers might want to take a different approach but should be aware of the following problems and be explicit in what is supported:</p><ul><li><p>Ignoring unknown input fields is actually not an option for PUT, since it becomes asymmetric with subsequent GET response and HTTP is clear about the PUT &quot;replace&quot; semantics and default roundtrip expectations (see <a href="https://tools.ietf.org/html/rfc7231#section-4.3.4" target="_blank" rel="noopener noreferrer">RFC7231 Section 4.3.4</a>). Note, accepting (i.e. not ignoring) unknown input fields and returning it in subsequent GET responses is a different situation and compliant to PUT semantics.</p></li><li><p>Certain client errors cannot be recognized by servers, e.g. attribute name typing errors will be ignored without server error feedback. The server cannot differentiate between the client intentionally providing an additional field versus the client sending a mistakenly named field, when the clientâ€™s actual intent was to provide an optional input field.</p></li><li><p>Future extensions of the input data structure might be in conflict with already ignored fields and, hence, will not be compatible, i.e. break clients that already use this field but with different type.</p></li></ul><p>In specific situations, where a (known) input field is not needed anymore, it either can stay in the API definition with &quot;not used anymore&quot; description or can be removed from the API definition as long as the server ignores this specific parameter.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="should-avoid-versioning"></a>SHOULD Avoid Versioning<a class="hash-link" href="#should-avoid-versioning" title="Direct link to heading">#</a></h2><p>When changing your RESTful APIs, do so in a compatible way and avoid generating additional API versions. Multiple versions can significantly complicate understanding, testing, maintaining, evolving, operating and releasing our systems <a href="http://martinfowler.com/articles/enterpriseREST.html" target="_blank" rel="noopener noreferrer">supplementary reading</a>).</p><p>If changing an API canâ€™t be done in a compatible way, then proceed in one of these three ways:</p><ul><li><p>create a new resource (variant) in addition to the old resource variant</p></li><li><p>create a new service endpoint â€” i.e. a new application with a new API (with a new domain name)</p></li><li><p>create a new API version supported in parallel with the old API by the same microservice</p></li></ul><p>As we discourage versioning by all means because of the manifold disadvantages, we strongly recommend to only use the first two approaches. Versioning should be a last resort.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="must-use-uri-versioning"></a>MUST Use URI Versioning<a class="hash-link" href="#must-use-uri-versioning" title="Direct link to heading">#</a></h2><p>With URI versioning a (major) version number is included in the path, e.g. /v1/customers. If you don&#x27;t put it in at the beginning then it&#x27;s almost impossible to retro-fit</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/compatibility.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#must-maintain-backward-compatibility" class="table-of-contents__link">MUST Maintain Backward Compatibility</a></li><li><a href="#should-prefer-compatible-changes" class="table-of-contents__link">SHOULD Prefer Compatible Changes</a></li><li><a href="#must-prepare-clients-to-not-crash-on-compatible-api-extensions" class="table-of-contents__link">MUST Prepare Clients To Not Crash On Compatible API Extensions</a></li><li><a href="#should-design-apis-conservatively" class="table-of-contents__link">SHOULD Design APIs Conservatively</a></li><li><a href="#should-avoid-versioning" class="table-of-contents__link">SHOULD Avoid Versioning</a></li><li><a href="#must-use-uri-versioning" class="table-of-contents__link">MUST Use URI Versioning</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Infrastructure-Playbook/styles.79c14b36.js"></script>
<script src="/Infrastructure-Playbook/runtime~main.9e5678c6.js"></script>
<script src="/Infrastructure-Playbook/main.cce976fb.js"></script>
<script src="/Infrastructure-Playbook/1.70185c52.js"></script>
<script src="/Infrastructure-Playbook/2.547559b9.js"></script>
<script src="/Infrastructure-Playbook/67.3e59262b.js"></script>
<script src="/Infrastructure-Playbook/70.9338f9b9.js"></script>
<script src="/Infrastructure-Playbook/935f2afb.1ccafd65.js"></script>
<script src="/Infrastructure-Playbook/17896441.decf34b9.js"></script>
<script src="/Infrastructure-Playbook/e29b0ef0.f3d10379.js"></script>
</body>
</html>