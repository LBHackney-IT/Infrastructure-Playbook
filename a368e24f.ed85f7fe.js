(window.webpackJsonp=window.webpackJsonp||[]).push([[22],{107:function(e,t,n){"use strict";n.d(t,"a",(function(){return b})),n.d(t,"b",(function(){return m}));var s=n(0),r=n.n(s);function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(e);t&&(s=s.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,s)}return n}function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t){if(null==e)return{};var n,s,r=function(e,t){if(null==e)return{};var n,s,r={},o=Object.keys(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(s=0;s<o.length;s++)n=o[s],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),n=t;return e&&(n="function"==typeof e?e(t):i(i({},t),e)),n},b=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},d=r.a.forwardRef((function(e,t){var n=e.components,s=e.mdxType,o=e.originalType,a=e.parentName,c=l(e,["components","mdxType","originalType","parentName"]),b=u(n),d=s,m=b["".concat(a,".").concat(d)]||b[d]||p[d]||o;return n?r.a.createElement(m,i(i({ref:t},c),{},{components:n})):r.a.createElement(m,i({ref:t},c))}));function m(e,t){var n=arguments,s=t&&t.mdxType;if("string"==typeof e||s){var o=n.length,a=new Array(o);a[0]=d;var i={};for(var l in t)hasOwnProperty.call(t,l)&&(i[l]=t[l]);i.originalType=e,i.mdxType="string"==typeof e?e:s,a[1]=i;for(var c=2;c<o;c++)a[c]=n[c];return r.a.createElement.apply(null,a)}return r.a.createElement.apply(null,n)}d.displayName="MDXCreateElement"},90:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return a})),n.d(t,"metadata",(function(){return i})),n.d(t,"toc",(function(){return l})),n.d(t,"default",(function(){return u}));var s=n(3),r=n(7),o=(n(0),n(107)),a={id:"permissions_management",title:"AWS Permissions"},i={unversionedId:"permissions_management",id:"permissions_management",isDocsHomePage:!1,title:"AWS Permissions",description:"General Ideas",source:"@site/docs/permissions_management.md",slug:"/permissions_management",permalink:"/Infrastructure-Playbook/permissions_management",editUrl:"https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/permissions_management.md",version:"current",sidebar:"docs",previous:{title:"SSO sync job",permalink:"/Infrastructure-Playbook/sso_sync"},next:{title:"Account provisioning",permalink:"/Infrastructure-Playbook/account_provisioning"}},l=[{value:"General Ideas",id:"general-ideas",children:[]},{value:"Google / SAML groups",id:"google--saml-groups",children:[]},{value:"Types of Users Needing Access",id:"types-of-users-needing-access",children:[]},{value:"Creating groups",id:"creating-groups",children:[]},{value:"Naming conventions for Google (SAML) groups",id:"naming-conventions-for-google-saml-groups",children:[]},{value:"Special Features",id:"special-features",children:[]},{value:"Group Description",id:"group-description",children:[]},{value:"Group Permissions",id:"group-permissions",children:[]},{value:"Group Membership",id:"group-membership",children:[]},{value:"Individual Access to an account",id:"individual-access-to-an-account",children:[]},{value:"Syncing a New Group with AWS",id:"syncing-a-new-group-with-aws",children:[]},{value:"Adding members / groups via SCIM",id:"adding-members--groups-via-scim",children:[]},{value:"Permission Sets",id:"permission-sets",children:[]},{value:"Custom Permission Sets",id:"custom-permission-sets",children:[]},{value:"AWS Permission Sets",id:"aws-permission-sets",children:[]}],c={toc:l};function u(e){var t=e.components,n=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(s.a)({},c,n,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h3",{id:"general-ideas"},"General Ideas"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Principle of least privilege "),"should apply to all users/groups. In other words, we only grant permissions access at a level necessary for users to undertake their work."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"Groups \u2013 and as often possible ",Object(o.b)("em",{parentName:"strong"},"not")," individuals "),"\u2013 with common access needs should be assigned access to accounts with appropriate permissions. See below for exceptions."),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"No adding teams by default"),": we do not assign an entire Hackney team the same access permissions as one another. Instead, those ",Object(o.b)("em",{parentName:"li"},"within")," a team that need access to AWS will get it. Seniority does not mean superior access. "),Object(o.b)("li",{parentName:"ul"},Object(o.b)("strong",{parentName:"li"},"aws-sso"),": this Slack channel is the appropriate place for other teams to request access. We ask that requesters provide the following information:",Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},"the name of the team/project"),Object(o.b)("li",{parentName:"ul"},"the account(s) they need to access"),Object(o.b)("li",{parentName:"ul"},"a similar user"),Object(o.b)("li",{parentName:"ul"},"their full-name / hackney email")))),Object(o.b)("h3",{id:"google--saml-groups"},"Google / SAML groups"),Object(o.b)("p",null,"We federate user access from our Google directory. This means users will automatically be able to access an application by logging in with their Hackney Google Account (SSO). "),Object(o.b)("p",null,"Our aim is to organise most access to AWS accounts and AppStream applications via groups of users with similar access needs. This is done via groups created in our Google directory that begin with the prefix \u201csaml\u201d."),Object(o.b)("h3",{id:"types-of-users-needing-access"},"Types of Users Needing Access"),Object(o.b)("p",null,"The types of users currently accessing Hackney\u2019s AWS environment can be roughly divided into three categories:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"Those building (in) the platform*;"),Object(o.b)("li",{parentName:"ul"},"Those working with resources that have been built (by others) in the platform;"),Object(o.b)("li",{parentName:"ul"},"Those needing access to a certain service in the platform \u2013 e.g. AppStream \u2013 in order to do their work.")),Object(o.b)("p",null,"*NB Even for those building (in) the platform, the majority of resources should be created using infrastructure as code and CI/CD pipelines, which utilise automated deployment roles rather than individuals\u2019 access permissions. As a result, although it can be argued that those building (in) the platform do require elevated permissions from time to time, their access permission level should still be moderate or limited. "),Object(o.b)("h3",{id:"creating-groups"},"Creating groups"),Object(o.b)("p",null,"Currently, we must request that a member of the service support team create a group. Soon there is likely to be a new process for requesting groups that is more auditable, provided by Halo. Please request that any new groups\u2019 names follow our guidelines below. "),Object(o.b)("h3",{id:"naming-conventions-for-google-saml-groups"},"Naming conventions for Google (SAML) groups"),Object(o.b)("h4",{id:"group-email-identifier"},"Group Email Identifier"),Object(o.b)("table",null,Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"<authentication mechanism>")),Object(o.b)("td",null,Object(o.b)("code",null,"-")),Object(o.b)("td",null,Object(o.b)("code",null,"<cloud platform>")),Object(o.b)("td",null,Object(o.b)("code",null,"-")),Object(o.b)("td",null,Object(o.b)("code",null,"<appstream> ")),Object(o.b)("td",null,Object(o.b)("code",null,"-")),Object(o.b)("td",null,Object(o.b)("code",null,"<application/project/service/team name>")),Object(o.b)("td",null,Object(o.b)("code",null,"-")),Object(o.b)("td",null,Object(o.b)("code",null,"<special features>")),Object(o.b)("td",null,Object(o.b)("code",null,"@hackney.gov.uk"))),Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"e.g. saml")),Object(o.b)("td",null),Object(o.b)("td",null,Object(o.b)("code",null,"e.g. aws")),Object(o.b)("td",null),Object(o.b)("td",null,Object(o.b)("code",null,"Where necessary")),Object(o.b)("td",null),Object(o.b)("td",null,Object(o.b)("code",null,"e.g. hrapplication1 , financeapplication1")),Object(o.b)("td",null),Object(o.b)("td",null,Object(o.b)("code",null,"Where necessary see below")),Object(o.b)("td",null))),Object(o.b)("p",null," ",Object(o.b)("strong",{parentName:"p"},"Note: all group names must be hyphenated and not capitalised. ")),Object(o.b)("h3",{id:"special-features"},"Special Features"),Object(o.b)("p",null,"Designation for groups with special access privileges or other features worthy of note. General access groups carry no designation."),Object(o.b)("p",null,"These suffixes are compoundable with hyphens, e.g., ",Object(o.b)("inlineCode",{parentName:"p"},"admin-staging.")),Object(o.b)("table",null,Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("strong",null,"Value")),Object(o.b)("td",null,Object(o.b)("strong",null,"Description"))),Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"admin")),Object(o.b)("td",null,"The group carries out administrative tasks requiring a higher privilege level and access to other associated software not normally available")),Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"readonly")),Object(o.b)("td",null,"The group does not have ordinary access to the application, and cannot change or manipulate data")),Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"staging")),Object(o.b)("td",null,"A group configured only for use in a staging environment, to test the application and configurations.")),Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("code",null,"developer")),Object(o.b)("td",null,"A group specifically tailored to Hackney developers and their work."))),Object(o.b)("h3",{id:"group-description"},"Group Description"),Object(o.b)("p",null,"This should always be completed by an Owner/Manager of the google group upon creation. The description should clearly describe:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"what service users will gain access to by being added to the group;"),Object(o.b)("li",{parentName:"ul"},"any special arrangements in place for adding users to the group;"),Object(o.b)("li",{parentName:"ul"},"identify services the application is hosted on and links to relevant documentation.")),Object(o.b)("p",null,"Eg. "),Object(o.b)("blockquote",null,Object(o.b)("p",{parentName:"blockquote"},"Add general users for financeapplication1 to this group. The application is delivered via AWS AppStream and further documentation can be found here: link.")),Object(o.b)("h3",{id:"group-permissions"},"Group Permissions"),Object(o.b)("p",null,"As these groups are used to control access to applications, it\u2019s important that the groups are properly configured to prevent users being added/removed without authorisation. "),Object(o.b)("table",null,Object(o.b)("tr",null,Object(o.b)("td",null,Object(o.b)("strong",null,"Option")),Object(o.b)("td",null,Object(o.b)("strong",null,"Value"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Access Type"),Object(o.b)("td",null,Object(o.b)("code",null,"Restricted"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Contact Owners"),Object(o.b)("td",null,Object(o.b)("code",null,"Group Members"))),Object(o.b)("tr",null,Object(o.b)("td",null,"View Members"),Object(o.b)("td",null,Object(o.b)("code",null,"Group Managers"))),Object(o.b)("tr",null,Object(o.b)("td",null,"View Conversations"),Object(o.b)("td",null,Object(o.b)("code",null,"Group Members"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Publish Posts"),Object(o.b)("td",null,Object(o.b)("code",null,"Group Managers"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Add, invite, approve new members"),Object(o.b)("td",null,Object(o.b)("code",null,"Group Managers"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Who can join this group"),Object(o.b)("td",null,Object(o.b)("code",null,"Only invited users"))),Object(o.b)("tr",null,Object(o.b)("td",null,"Allow members outside your organisation"),Object(o.b)("td",null,Object(o.b)("code",null,"False")))),Object(o.b)("h3",{id:"group-membership"},"Group Membership"),Object(o.b)("p",null,"The default Group Owner should be set to a ",Object(o.b)("inlineCode",{parentName:"p"},"G Suite (Service Account)")," unless there\u2019s a technical reason to use an alternative service account. The Group Owner should never be set to a specific user."),Object(o.b)("p",null,"Our aim is to ensure that the management of these groups will quickly pass over to the team leads \u2013 preferably Hackney staff \u2013 who operationally manage access to the account/application in question. The Group Managers will add new Group Members as needed. "),Object(o.b)("p",null,"Once a group has been created, Managers can add Members to the group as described in ",Object(o.b)("a",{parentName:"p",href:"https://support.google.com/groups/answer/2465464?hl=en"},"this Google documentation"),", section ",Object(o.b)("strong",{parentName:"p"},"Add people to your group directly"),". "),Object(o.b)("h3",{id:"individual-access-to-an-account"},"Individual Access to an account"),Object(o.b)("p",null,"Although it is preferable that groups are given access rather than individuals, there are some cases in which giving an individual access may be more secure than giving a group access. Good reasons for granting an individual access to an account:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"If that individual\u2019s access is temporary;"),Object(o.b)("li",{parentName:"ul"},"If, by granting a group access instead of an individual, you would be granting access to other individuals who should ",Object(o.b)("strong",{parentName:"li"},"not")," have access to that account.")),Object(o.b)("h3",{id:"syncing-a-new-group-with-aws"},"Syncing a New Group with AWS"),Object(o.b)("p",null,"Follow the guide for adding a new group to Parameter Store ",Object(o.b)("a",{parentName:"p",href:"https://docs.google.com/document/d/1feFvMXTk26Brw0495DqBjOM0y5ZsVYAgaAVsmRtD600/edit#heading=h.9qr01v8jkz11"},"here"),". "),Object(o.b)("h3",{id:"adding-members--groups-via-scim"},"Adding members / groups via SCIM"),Object(o.b)("p",null,"Although it is preferable to simply add users to their respective groups and wait for the SSO Sync to run, it is possible to quickly add groups or add users to existing groups via Postman and SCIM. ",Object(o.b)("em",{parentName:"p"},"Please ask those existing members of the team who have this set up to help. ")),Object(o.b)("h3",{id:"permission-sets"},"Permission Sets"),Object(o.b)("p",null,"We are currently using a variety of custom and AWS permission sets in order to grant access to different Google groups across Hackney\u2019s AWS environment. The way in which we use these permission sets is likely to change soon. Permission sets consist of both custom/inline and managed policies. ",Object(o.b)("a",{parentName:"p",href:"https://docs.aws.amazon.com/singlesignon/latest/userguide/permissionsetsconcept.html"},"Read more on permission sets here"),". "),Object(o.b)("h3",{id:"custom-permission-sets"},"Custom Permission Sets"),Object(o.b)("p",null,"We use a range of custom permission sets based around the different types of users listed above."),Object(o.b)("h3",{id:"aws-permission-sets"},"AWS Permission Sets"),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://eu-west-1.console.aws.amazon.com/singlesignon/home?region=eu-west-1#/accounts/permissionSets/details/ps-568cee9a894e9dcc"},"AWSReadOnlyAccess")),Object(o.b)("p",null,"This policy grants permissions to view resources and basic metadata across all AWS services"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("em",{parentName:"strong"},"This permission set can be applied widely with minimal risk. "))),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://eu-west-1.console.aws.amazon.com/singlesignon/home?region=eu-west-1#/accounts/permissionSets/details/ps-4fe1d70d7281362b"},"AWSPowerUserAccess")),Object(o.b)("p",null,"Provides full access to AWS services and resources, but does not allow management of Users and groups"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("em",{parentName:"strong"},"This permission set is far too powerful for most users. It should be granted sparingly and preferably in lower environments. "))),Object(o.b)("p",null,Object(o.b)("a",{parentName:"p",href:"https://eu-west-1.console.aws.amazon.com/singlesignon/home?region=eu-west-1#/accounts/permissionSets/details/ps-f081f31984ce35a5"},"AWSAdministratorAccess")),Object(o.b)("p",null,"Provides full access to AWS services and resources"),Object(o.b)("p",null,Object(o.b)("strong",{parentName:"p"},Object(o.b)("em",{parentName:"strong"},"This permission set should be granted extremely sparingly in Production environments; preferably those who need it should only be temporarily elevated to this permission set before being demoted to a more safe access level. "))))}u.isMDXComponent=!0}}]);