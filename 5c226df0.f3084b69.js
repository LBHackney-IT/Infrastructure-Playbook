(window.webpackJsonp=window.webpackJsonp||[]).push([[24],{135:function(e,t,a){"use strict";a.d(t,"a",(function(){return d})),a.d(t,"b",(function(){return m}));var n=a(0),r=a.n(n);function o(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function i(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function l(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?i(Object(a),!0).forEach((function(t){o(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):i(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,r=function(e,t){if(null==e)return{};var a,n,r={},o=Object.keys(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||(r[a]=e[a]);return r}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(n=0;n<o.length;n++)a=o[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(r[a]=e[a])}return r}var c=r.a.createContext({}),u=function(e){var t=r.a.useContext(c),a=t;return e&&(a="function"==typeof e?e(t):l(l({},t),e)),a},d=function(e){var t=u(e.components);return r.a.createElement(c.Provider,{value:t},e.children)},b={inlineCode:"code",wrapper:function(e){var t=e.children;return r.a.createElement(r.a.Fragment,{},t)}},p=r.a.forwardRef((function(e,t){var a=e.components,n=e.mdxType,o=e.originalType,i=e.parentName,c=s(e,["components","mdxType","originalType","parentName"]),d=u(a),p=n,m=d["".concat(i,".").concat(p)]||d[p]||b[p]||o;return a?r.a.createElement(m,l(l({ref:t},c),{},{components:a})):r.a.createElement(m,l({ref:t},c))}));function m(e,t){var a=arguments,n=t&&t.mdxType;if("string"==typeof e||n){var o=a.length,i=new Array(o);i[0]=p;var l={};for(var s in t)hasOwnProperty.call(t,s)&&(l[s]=t[s]);l.originalType=e,l.mdxType="string"==typeof e?e:n,i[1]=l;for(var c=2;c<o;c++)i[c]=a[c];return r.a.createElement.apply(null,i)}return r.a.createElement.apply(null,a)}p.displayName="MDXCreateElement"},92:function(e,t,a){"use strict";a.r(t),a.d(t,"frontMatter",(function(){return i})),a.d(t,"metadata",(function(){return l})),a.d(t,"toc",(function(){return s})),a.d(t,"default",(function(){return u}));var n=a(3),r=a(7),o=(a(0),a(135)),i={id:"data-formats",title:"Data Formats"},l={unversionedId:"data-formats",id:"data-formats",isDocsHomePage:!1,title:"Data Formats",description:"MUST Use JSON to Encode Structured Data",source:"@site/docs/data-formats.md",slug:"/data-formats",permalink:"/Infrastructure-Playbook/data-formats",editUrl:"https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/data-formats.md",version:"current"},s=[{value:"MUST Use JSON to Encode Structured Data",id:"must-use-json-to-encode-structured-data",children:[]},{value:"MUST use camelCase property names: <code>^[a-z][A-Z0-9]*$</code>",id:"must-use-camelcase-property-names-a-za-z0-9",children:[]},{value:"MUST pluralise array names",id:"must-pluralise-array-names",children:[]},{value:"MUST Boolean property values must not be null",id:"must-boolean-property-values-must-not-be-null",children:[]},{value:"SHOULD Null values should have their fields removed",id:"should-null-values-should-have-their-fields-removed",children:[]},{value:"MUST not use null values for empty array",id:"must-not-use-null-values-for-empty-array",children:[]},{value:"MAY Use non-JSON Media Types for Binary Data or Alternative Content Representations",id:"may-use-non-json-media-types-for-binary-data-or-alternative-content-representations",children:[]},{value:"MUST Use Standard Date and Time Formats",id:"must-use-standard-date-and-time-formats",children:[{value:"JSON Payload",id:"json-payload",children:[]},{value:"HTTP headers",id:"http-headers",children:[]}]},{value:"MAY Use Standards for Country, Language and Currency Codes",id:"may-use-standards-for-country-language-and-currency-codes",children:[]},{value:"MUST Define Format for Type Number and Integer",id:"must-define-format-for-type-number-and-integer",children:[]},{value:"SHOULD Date property values should conform to RFC 3339",id:"should-date-property-values-should-conform-to-rfc-3339",children:[]},{value:"SHOULD Time durations and intervals could conform to ISO 8601",id:"should-time-durations-and-intervals-could-conform-to-iso-8601",children:[]},{value:"SHOULD Use standards for Language, Country and Currency",id:"should-use-standards-for-language-country-and-currency",children:[]}],c={toc:s};function u(e){var t=e.components,a=Object(r.a)(e,["components"]);return Object(o.b)("wrapper",Object(n.a)({},c,a,{components:t,mdxType:"MDXLayout"}),Object(o.b)("h2",{id:"must-use-json-to-encode-structured-data"},"MUST Use JSON to Encode Structured Data"),Object(o.b)("p",null,"We use a minimal JSON representation to output objects from the API. This may in the future be extended to use  ",Object(o.b)("a",{parentName:"p",href:"https://jsonapi.org/"},"JSON:API")," if the functionality it offers is beneficial, however we are taking the approach of starting simple and extending if necessary. This could be done in a backwards compatible way by representing the same objects in a JSON:API structure as well as the simple JSON structure."),Object(o.b)("p",null,"The structure we currently use is:"),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"A single object"),"\nA simple collection of attributes and their values. The attributes should be camel-cased."),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-JSON"},'{\n  "id" : 1,\n  "title" : "A blog post",\n  "body" : "Some useful content"\n}\n')),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"A collection of objects"),"\nThis should have a root element matching the pluralised name of the object:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-JSON"},'{\n  posts: [\n    {\n      "id" : 1,\n      "title" : "A blog post",\n      "body" : "Some useful content"\n    },\n    {\n      "id" : 2,\n      "title" : "Another blog post",\n      "body" : "More content"\n    }\n  ]\n}\n')),Object(o.b)("p",null,Object(o.b)("em",{parentName:"p"},"An error object"),"\nWe use the status code to represent the success or failure of a request. We also pass back an object with more information about the error:"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-JSON"},'{\n    "status" : "fail",\n    "errors" : [ "A title is required" ]\n}\n')),Object(o.b)("h2",{id:"must-use-camelcase-property-names-a-za-z0-9"},"MUST use camelCase property names: ",Object(o.b)("inlineCode",{parentName:"h2"},"^[a-z][A-Z0-9]*$")),Object(o.b)("p",null,"Property names are restricted to ASCII strings. The first character must be a letter, or an underscore, and subsequent characters can be a letter, or a number."),Object(o.b)("h2",{id:"must-pluralise-array-names"},"MUST pluralise array names"),Object(o.b)("p",null,"To indicate they contain multiple values we prefer to pluralise array names. This implies that object names should in turn be singular."),Object(o.b)("h2",{id:"must-boolean-property-values-must-not-be-null"},"MUST Boolean property values must not be null"),Object(o.b)("p",null,"Schema based JSON properties that are by design booleans must not be presented as nulls. A boolean is essentially a closed enumeration of two values, true and false. If the content has a meaningful null value, strongly prefer to replace the boolean with enumeration of named values or statuses - for example acceptedTermsAndConditions with true or false can be replaced with termsAndConditions with values yes, no and unknown."),Object(o.b)("h2",{id:"should-null-values-should-have-their-fields-removed"},"SHOULD Null values should have their fields removed"),Object(o.b)("p",null,"OpenAPI, which is in common use, doesn\u2019t support null field values (it does allow omitting that field completely if it is not marked as required). However that doesn\u2019t prevent clients and servers sending and receiving those fields with null values. Also, in some cases null may be a meaningful value - for example, JSON Merge Patch ",Object(o.b)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc7386"},"RFC 7382"),") using null to indicate property deletion."),Object(o.b)("h2",{id:"must-not-use-null-values-for-empty-array"},"MUST not use null values for empty array"),Object(o.b)("p",null,"Empty array values can unambiguously be represented as the empty list,",Object(o.b)("inlineCode",{parentName:"p"},"[]"),"."),Object(o.b)("h2",{id:"may-use-non-json-media-types-for-binary-data-or-alternative-content-representations"},"MAY Use non-JSON Media Types for Binary Data or Alternative Content Representations"),Object(o.b)("p",null,"Other media types may be used in following cases:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"Transferring binary data or data whose structure is not relevant. This is the case if payload structure is not interpreted and consumed by clients as is. Example of such use case is downloading images in formats JPG, PNG, GIF.")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},"In addition to JSON version alternative data representations (e.g. in formats PDF, DOC, XML) may be made available through content negotiation."))),Object(o.b)("h2",{id:"must-use-standard-date-and-time-formats"},"MUST Use Standard Date and Time Formats"),Object(o.b)("h3",{id:"json-payload"},"JSON Payload"),Object(o.b)("p",null,"Represent date and time format as ",Object(o.b)("a",{parentName:"p",href:"#should-date-property-values-should-conform-to-rfc-3339"},"RFC 3339"),"."),Object(o.b)("h3",{id:"http-headers"},"HTTP headers"),Object(o.b)("p",null,"HTTP headers including the proprietary headers use the ",Object(o.b)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc7231#section-7.1.1.1"},"HTTP date format defined in RFC 7231"),"."),Object(o.b)("h2",{id:"may-use-standards-for-country-language-and-currency-codes"},"MAY Use Standards for Country, Language and Currency Codes"),Object(o.b)("p",null,"Use the following standard formats for country, language and currency codes:"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/ISO_3166-1_alpha-2"},"ISO 3166-1-alpha2 country codes")),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},'(It is "GB", not "UK", even though "UK" has seen some use at\nZalando)'))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes"},"ISO 639-1 language code")),Object(o.b)("ul",{parentName:"li"},Object(o.b)("li",{parentName:"ul"},Object(o.b)("a",{parentName:"li",href:"https://tools.ietf.org/html/bcp47"},"BCP-47")," (based on ISO 639-1)\nfor language variants"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/ISO_4217"},"ISO 4217 currency codes")))),Object(o.b)("h2",{id:"must-define-format-for-type-number-and-integer"},"MUST Define Format for Type Number and Integer"),Object(o.b)("p",null,"Whenever an API defines a property of type ",Object(o.b)("inlineCode",{parentName:"p"},"number")," or ",Object(o.b)("inlineCode",{parentName:"p"},"integer"),", the precision must be defined by the format as follows to prevent clients from guessing the precision incorrectly, and thereby changing the value unintentionally:"),Object(o.b)("table",null,Object(o.b)("thead",{parentName:"table"},Object(o.b)("tr",{parentName:"thead"},Object(o.b)("th",{parentName:"tr",align:null},"type"),Object(o.b)("th",{parentName:"tr",align:null},"format"),Object(o.b)("th",{parentName:"tr",align:null},"specified value range"))),Object(o.b)("tbody",{parentName:"table"},Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"integer"),Object(o.b)("td",{parentName:"tr",align:null},"int32"),Object(o.b)("td",{parentName:"tr",align:null},"integer between -2^31 and 2^31-1")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"integer"),Object(o.b)("td",{parentName:"tr",align:null},"int64"),Object(o.b)("td",{parentName:"tr",align:null},"integer between -2^63 and 2^63-1")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"integer"),Object(o.b)("td",{parentName:"tr",align:null},"bigint"),Object(o.b)("td",{parentName:"tr",align:null},"arbitrarily large signed integer number")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"number"),Object(o.b)("td",{parentName:"tr",align:null},"float"),Object(o.b)("td",{parentName:"tr",align:null},"IEEE 754-2008/ISO 60559:2011 binary64 decimal number")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"number"),Object(o.b)("td",{parentName:"tr",align:null},"double"),Object(o.b)("td",{parentName:"tr",align:null},"IEEE 754-2008/ISO 60559:2011 binary128 decimal number")),Object(o.b)("tr",{parentName:"tbody"},Object(o.b)("td",{parentName:"tr",align:null},"number"),Object(o.b)("td",{parentName:"tr",align:null},"decimal"),Object(o.b)("td",{parentName:"tr",align:null},"arbitrarily precise signed decimal number")))),Object(o.b)("p",null,"The precision must be translated by clients and servers into the most specific language types. E.g. for the following definitions the most specific language types in Java will translate to ",Object(o.b)("inlineCode",{parentName:"p"},"BigDecimal")," for ",Object(o.b)("inlineCode",{parentName:"p"},"Money.amount")," and ",Object(o.b)("inlineCode",{parentName:"p"},"int")," or ",Object(o.b)("inlineCode",{parentName:"p"},"Integer")," for the ",Object(o.b)("inlineCode",{parentName:"p"},"OrderList.page_size"),":"),Object(o.b)("pre",null,Object(o.b)("code",{parentName:"pre",className:"language-yaml"},"components:\n  schemas:\n    Money:\n      type: object\n      properties:\n        amount:\n          type: number\n          description: Amount expressed as a decimal number of major currency units\n          format: decimal\n          example: 99.95\n       ...\n\n    OrderList:\n      type: object\n      properties:\n        page_size:\n          type: integer\n          description: Number of orders in list\n          format: int32\n          example: 42\n")),Object(o.b)("h2",{id:"should-date-property-values-should-conform-to-rfc-3339"},"SHOULD Date property values should conform to RFC 3339"),Object(o.b)("p",null,"Use the date and time formats defined by ",Object(o.b)("a",{parentName:"p",href:"http://tools.ietf.org/html/rfc3339#section-5.6"},"RFC 3339"),":"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},'for "date" use strings matching ',Object(o.b)("inlineCode",{parentName:"p"},'date-fullyear "-" date-month "-" date-mday'),", for example: ",Object(o.b)("inlineCode",{parentName:"p"},"2015-05-28"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},'for "date-time" use strings matching ',Object(o.b)("inlineCode",{parentName:"p"},'full-date "T" full-time'),", for example ",Object(o.b)("inlineCode",{parentName:"p"},"2015-05-28T14:07:17Z")))),Object(o.b)("p",null,"Note that the ",Object(o.b)("a",{parentName:"p",href:"https://github.com/OAI/OpenAPI-Specification/blob/master/versions/2.0.md#data-types"},"OpenAPI format"),'\n"date-time" corresponds to "date-time" in the RFC) and ',Object(o.b)("inlineCode",{parentName:"p"},"2015-05-28"),' for a date (note that the OpenAPI format "date" corresponds to "full-date" in the RFC). Both are specific profiles, a subset of the international standard ',Object(o.b)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/ISO_8601"},"ISO 8601"),"."),Object(o.b)("p",null,"A zone offset may be used (both, in request and responses)\u2009\u2014\u2009this is simply defined by the standards. However, we encourage restricting dates to UTC and without offsets. For example ",Object(o.b)("inlineCode",{parentName:"p"},"2015-05-28T14:07:17Z")," rather than ",Object(o.b)("inlineCode",{parentName:"p"},"2015-05-28T14:07:17+00:00"),". From experience we have learned that zone offsets are not easy to understand and often not correctly handled. Note also that zone offsets are different from local times that might be including daylight saving time. Localization of dates should be done by the services that provide user interfaces, if required."),Object(o.b)("p",null,"When it comes to storage, all dates should be consistently stored in UTC without a zone offset. Localization should be done locally by the services that provide user interfaces, if required."),Object(o.b)("p",null,"Sometimes it can seem data is naturally represented using numerical timestamps, but this can introduce interpretation issues with precision"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},"for example whether to represent a timestamp as 1460062925, 1460062925000 or 1460062925.000. Date strings, though more verbose and requiring more effort to parse, avoid this ambiguity.")),Object(o.b)("h2",{id:"should-time-durations-and-intervals-could-conform-to-iso-8601"},"SHOULD Time durations and intervals could conform to ISO 8601"),Object(o.b)("p",null,"Schema based JSON properties that are by design durations and intervals could be strings formatted as recommended by ISO 8601 (",Object(o.b)("a",{parentName:"p",href:"https://tools.ietf.org/html/rfc3339#appendix-A"},"Appendix A of RFC 3339 contains a grammar")," for durations)."),Object(o.b)("h2",{id:"should-use-standards-for-language-country-and-currency"},"SHOULD Use standards for Language, Country and Currency"),Object(o.b)("ul",null,Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/ISO_3166-1_alpha-2"},"ISO 3166-1-alpha2 country"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/List_of_ISO_639-1_codes"},"ISO 639-1 language code"))),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"https://tools.ietf.org/html/bcp47"},"BCP-47")," (based on ISO 639-1) for language variants")),Object(o.b)("li",{parentName:"ul"},Object(o.b)("p",{parentName:"li"},Object(o.b)("a",{parentName:"p",href:"http://en.wikipedia.org/wiki/ISO_4217"},"ISO 4217 currency codes")))))}u.isMDXComponent=!0}}]);