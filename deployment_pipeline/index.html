<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Infrastructure-Playbook/blog/rss.xml" title="Hackney Infrastructure Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Infrastructure-Playbook/blog/atom.xml" title="Hackney Infrastructure Playbook Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Infrastructure Playbook" href="/Infrastructure-Playbook/opensearch.xml"><title data-react-helmet="true">Deployment Pipeline | Hackney Infrastructure Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Deployment Pipeline | Hackney Infrastructure Playbook"><meta data-react-helmet="true" name="description" content="Introduction"><meta data-react-helmet="true" property="og:description" content="Introduction"><meta data-react-helmet="true" property="og:url" content="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/deployment_pipeline"><link data-react-helmet="true" rel="shortcut icon" href="/Infrastructure-Playbook/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/deployment_pipeline"><link rel="stylesheet" href="/Infrastructure-Playbook/styles.2116970b.css">
<link rel="stylesheet" href="/Infrastructure-Playbook/main.4a16e2e4.css">
<link rel="preload" href="/Infrastructure-Playbook/styles.79c14b36.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/runtime~main.05c96792.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/main.cce976fb.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/1.70185c52.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/2.547559b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/67.3e59262b.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/70.9338f9b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/935f2afb.1ccafd65.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/17896441.decf34b9.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/d0b28ad8.eb78cf3a.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Deployment Pipeline</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="introduction"></a>Introduction<a class="hash-link" href="#introduction" title="Direct link to heading">#</a></h2><p>A Deployment pipeline is the process of taking code from a version control repo, such as Github, and releasing a version or the master branch to our deployment environments in an automated fashion.</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="video-tutorial"></a>Video Tutorial<a class="hash-link" href="#video-tutorial" title="Direct link to heading">#</a></h2><p><strong> For an overview of our Deployment Pipeline setup using Circle CI, please watch our short video tutorial: </strong></p><figure class="video-container"><iframe width="100%" src="https://www.youtube.com/embed/X68e_wdII2c" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe></figure><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="cicd"></a>CI/CD<a class="hash-link" href="#cicd" title="Direct link to heading">#</a></h2><p>We use CI/CD in Hackney as an efficient way to build, test and deploy new code.
CI/CD is short for <strong> Continuous Integration and Continuous Delivery/Deployment </strong> .</p><p><strong> CI/CD works in conjunction with the following processes: </strong></p><ul><li>Version control (branches, commits, merges)</li><li>Build automation/continuous integration</li><li>Test automation</li><li>Deploy automation</li></ul><p>We use a combination of software functions in Github and Circle CI, configured via a YAML file to fully automate environment deployments. Our deployments will usually support a <strong>development</strong>, <strong>staging</strong>, and <strong>production</strong> environment.</p><p>The CI/CD YAML configuration is stored in a file in the <code>.circleci</code> folder. The YAML configuration contains all the steps which will be carried out in Circle CI as part of the deployment.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="continuous-testing"></a>Continuous testing<a class="hash-link" href="#continuous-testing" title="Direct link to heading">#</a></h3><p>Unit and integration tests must be run as part of the CI/CD pipeline at the point of:</p><ol><li>Code committed to remote branch</li><li>Deployment to different environments</li></ol><p>We use the Test-Driven Development (TDD) approach when writing code.</p><p>Each projectâ€™s test suite must include units tests produced as part of TDD as well as integration tests.</p><p><strong> More on practices in Hackney for writing tests here: <a href="/Infrastructure-Playbook/tdd">TDD Practices</a> </strong></p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="environments"></a>Environments<a class="hash-link" href="#environments" title="Direct link to heading">#</a></h2><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="development"></a>Development<a class="hash-link" href="#development" title="Direct link to heading">#</a></h3><p>The deployment process is initiated via a push to a feature branch in Github. All branch pushes are built and code tests are run. Branches with failing tests or builds cannot be merged into the master branch which is used for deployments.</p><p><img alt="Tests for code pushes" src="/Infrastructure-Playbook/assets/images/pull_requests-7e9dca0fa61d11738541f59ce133544a.png">
<em>Diagram of the process that happens when pushing code to GitHub</em></p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="pull-requests"></a>Pull requests<a class="hash-link" href="#pull-requests" title="Direct link to heading">#</a></h4><p>Before a feature branch can be merged into development, after a successful build and test, it is marked for code review via a PR (Pull Request) in Github. You can use the <a href="https://github.com/LBHackney-IT/lbh-base-api/blob/master/pull_request_template.md" target="_blank" rel="noopener noreferrer">Base API PR template</a>, which needs to be completed with as much detail as possible, including a link to the JIRA ticket of the work done. There needs to be a minimum of 1 approver per PR prior to merging. An approved and merged PR will then trigger a CircleCI workflow to automatically deploy to the Development enviroment.</p><h4><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="workflow"></a>Workflow<a class="hash-link" href="#workflow" title="Direct link to heading">#</a></h4><p><img alt="Development deployment workflow" src="/Infrastructure-Playbook/assets/images/dev_workflow-3486433985b9ce4751a9b48d1ee27c84.png">
<em>Merging into a â€˜developmentâ€™ branch triggers the â€˜development deploymentâ€™ workflow</em></p><p>The first steps for a deployment are usually the code formatting check, code build and test, deployment software tools installation, assignment of necessary security roles for deployments to AWS Lambda.</p><p>The successful completion of all of these steps will allow automated code deployment to the development environments.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="staging-and-production"></a>Staging and Production<a class="hash-link" href="#staging-and-production" title="Direct link to heading">#</a></h3><p><img alt="Staging &amp;amp; Prod Workflow" src="/Infrastructure-Playbook/assets/images/staging_workflow-01eb8ff54bdfa470e72ab8960692b7a2.png">
<em>Merging into the â€˜masterâ€™ branch automatically deploys to the staging environment</em></p><p>In order to deploy to staging and production environments, manual approval in Circle CI is required as the final step.</p><p><img alt="CircleCI Workflow" src="/Infrastructure-Playbook/assets/images/pull_request2-972976954fed4ea3f702df1a3846d8ae.png">
<em>The CircleCI workflow</em></p><p>The automation of the deployment to different environments gives flexibility in making small changes to the code and testing of features before deployment to a production environment.</p><p>Deployment automation means we decrease the possibility of human error when releasing new versions of code to deployment environments.</p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/deployment_pipeline.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"></div><div class="pagination-nav__item pagination-nav__item--next"></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#introduction" class="table-of-contents__link">Introduction</a></li><li><a href="#video-tutorial" class="table-of-contents__link">Video Tutorial</a></li><li><a href="#cicd" class="table-of-contents__link">CI/CD</a><ul><li><a href="#continuous-testing" class="table-of-contents__link">Continuous testing</a></li></ul></li><li><a href="#environments" class="table-of-contents__link">Environments</a><ul><li><a href="#development" class="table-of-contents__link">Development</a></li><li><a href="#staging-and-production" class="table-of-contents__link">Staging and Production</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Infrastructure-Playbook/styles.79c14b36.js"></script>
<script src="/Infrastructure-Playbook/runtime~main.05c96792.js"></script>
<script src="/Infrastructure-Playbook/main.cce976fb.js"></script>
<script src="/Infrastructure-Playbook/1.70185c52.js"></script>
<script src="/Infrastructure-Playbook/2.547559b9.js"></script>
<script src="/Infrastructure-Playbook/67.3e59262b.js"></script>
<script src="/Infrastructure-Playbook/70.9338f9b9.js"></script>
<script src="/Infrastructure-Playbook/935f2afb.1ccafd65.js"></script>
<script src="/Infrastructure-Playbook/17896441.decf34b9.js"></script>
<script src="/Infrastructure-Playbook/d0b28ad8.eb78cf3a.js"></script>
</body>
</html>