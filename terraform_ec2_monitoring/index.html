<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-alpha.70">
<link rel="alternate" type="application/rss+xml" href="/Infrastructure-Playbook/blog/rss.xml" title="Hackney Infrastructure Playbook Blog RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/Infrastructure-Playbook/blog/atom.xml" title="Hackney Infrastructure Playbook Blog Atom Feed">
<link rel="search" type="application/opensearchdescription+xml" title="Hackney Infrastructure Playbook" href="/Infrastructure-Playbook/opensearch.xml"><title data-react-helmet="true">Monitoring a Windows ec2 instance | Hackney Infrastructure Playbook</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" name="docsearch:language" content="en"><meta data-react-helmet="true" name="docsearch:version" content="current"><meta data-react-helmet="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Monitoring a Windows ec2 instance | Hackney Infrastructure Playbook"><meta data-react-helmet="true" name="description" content="Overview"><meta data-react-helmet="true" property="og:description" content="Overview"><meta data-react-helmet="true" property="og:url" content="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/terraform_ec2_monitoring"><link data-react-helmet="true" rel="shortcut icon" href="/Infrastructure-Playbook/img/favicon.png"><link data-react-helmet="true" rel="preconnect" href="https://BH4D9OD16A-dsn.algolia.net" crossorigin="anonymous"><link data-react-helmet="true" rel="canonical" href="https://lbhackney-it.github.io/Infrastructure-Playbook/Infrastructure-Playbook/terraform_ec2_monitoring"><link rel="stylesheet" href="/Infrastructure-Playbook/styles.2116970b.css">
<link rel="stylesheet" href="/Infrastructure-Playbook/main.4a16e2e4.css">
<link rel="preload" href="/Infrastructure-Playbook/styles.72619473.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/runtime~main.d9d6ccd6.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/main.8f09436c.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/1.c04c7cbc.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/2.3728f161.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/28.4cd0fd7b.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/31.c0b947cf.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/935f2afb.8d58e0da.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/17896441.47489b2e.js" as="script">
<link rel="preload" href="/Infrastructure-Playbook/af5ec72b.832e515d.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<nav aria-label="Skip navigation links"><button type="button" tabindex="0" class="skipToContent_11B0">Skip to main content</button></nav><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg aria-label="Menu" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_2N3Q"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_3NWk">ðŸŒœ</span></div><div class="react-toggle-track-x"><span class="toggle_3NWk">ðŸŒž</span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><svg width="20" height="20" class="DocSearch-Search-Icon" viewBox="0 0 20 20"><path d="M14.386 14.386l4.0877 4.0877-4.0877-4.0877c-2.9418 2.9419-7.7115 2.9419-10.6533 0-2.9419-2.9418-2.9419-7.7115 0-10.6533 2.9418-2.9419 7.7115-2.9419 10.6533 0 2.9419 2.9418 2.9419 7.7115 0 10.6533z" stroke="currentColor" fill="none" fill-rule="evenodd" stroke-linecap="round" stroke-linejoin="round"></path></svg><span class="DocSearch-Button-Placeholder">Search</span></span></button></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/Infrastructure-Playbook/"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--light_3CMI navbar__logo"><img src="/Infrastructure-Playbook/img/logo-long.svg" alt="Infrastructure Playbook" class="themedImage_YANc themedImage--dark_3ARp navbar__logo"><strong class="navbar__title">Infrastructure Playbook</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_vMrn"><div class="docSidebarContainer_3Ak5" role="complementary"><div class="sidebar_3gvy"><div class="menu menu--responsive thin-scrollbar menu_1yIk"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_1CUI" width="24" height="24" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Home</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/">Introduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/the_team">The Hackney Cloud Engineering team</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Info</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/services_we_provide">Services we provide</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/support_processes">Support processes</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/control_tower">Control Tower</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/sso_sync">SSO sync job</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/permissions_management">Permissions management</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/account_provisioning">Account provisioning</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/hub">The hub</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/change_process">Change Process</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/Infrastructure-Playbook/backups">Backup module</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">How-To guides</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/terraform_ec2">Creating an ec2 instance</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/Infrastructure-Playbook/terraform_ec2_monitoring">Monitoring a Windows ec2 instance</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/certificates">Certificate module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/creating_accounts">Creating a new AWS account</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/dns">DNS Module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/overnight_shutdown">Overnight shutdown module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/patching">Patching module</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/Infrastructure-Playbook/tagging">Tagging module</a></li></ul></li><li class="menu__list-item"><a class="menu__link" href="/Infrastructure-Playbook/contact_us">Contact The Hackney Cloud Engineering team</a></li></ul></div></div></div><main class="docMainContainer_2iGs"><div class="container padding-vert--lg docItemWrapper_1bxp"><div class="row"><div class="col docItemCol_U38p"><div class="docItemContainer_a7m4"><article><header><h1 class="docTitle_Oumm">Monitoring a Windows ec2 instance</h1></header><div class="markdown"><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="overview"></a>Overview<a class="hash-link" href="#overview" title="Direct link to heading">#</a></h2><p>This module deploys monitoring and alerting of Windows EC2 instances.</p><p>It will:</p><ul><li>Save the Cloudwatch Agent configuration into the parameter store</li><li>Create Cloudwatch rules for installing and configuring the Cloudwatch agent on instances</li><li>Create an SNS queue and add a subscription for the provided email address(es)</li><li>Create Cloudwatch alarms for either the default or provided metrics</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="usage"></a>Usage<a class="hash-link" href="#usage" title="Direct link to heading">#</a></h2><p>Declare the module and provide the required inputs and optional inputs as needed:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-terraform codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">module &quot;monitoring&quot; {</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  source = &quot;../../../modules/ec2-monitoring/module&quot;</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  tags          = module.tags.values</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  ec2_instance_ids = local.ec2_instances</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  alert_emails = local.alert_emails</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">}</span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><p><code>ec2_instance_ids</code> is a list of strings that holds the instance_ids of the instances you want to monitor.</p><p><code>alert_emails</code> is a list of strings that holds the email addresses you want to receive alerts. (Any new subscription will need to be confirmed by clicking on the &quot;Confirm Subscription&quot; link in the email that is sent post deployment).</p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="default-monitors-and-alerts"></a>Default monitors and alerts<a class="hash-link" href="#default-monitors-and-alerts" title="Direct link to heading">#</a></h2><p>By default, the module will alarm for:</p><ul><li>Instance status (when the instance is offline)</li><li>CPU &gt; 80% for 5 minutes</li><li>Free space on C: drive less than 20% for one hour</li><li>Memory above 80% for 5 minutes</li></ul><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="custom-monitoring"></a>Custom monitoring<a class="hash-link" href="#custom-monitoring" title="Direct link to heading">#</a></h2><p>Custom monitoring can be implemented by providing the following optional variables:</p><p><code>ssm_cloudwatch_config_windows_value</code> is a JSON file which tells the Cloudwatch agent what metrics from the operating system to output to Cloudwatch. Examples can be found <a href="https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html#CloudWatch-Agent-Configuration-File-Complete-Example" target="_blank" rel="noopener noreferrer">https://docs.aws.amazon.com/AmazonCloudWatch/latest/monitoring/CloudWatch-Agent-Configuration-File-Details.html#CloudWatch-Agent-Configuration-File-Complete-Example</a> </p><p>The default Cloudwatch Agent config for this project can be found <a href="/Infrastructure-Playbook/module/default-config/AmazonCloudwatch-windows.json">here</a>.
New Metrics can be either added to the default config if they are likely to be needed across all instances at Hackney, or the file can be copied, amended and provided as an optional value in the <code>ssm_cloudwatch_config_windows_value</code> variable.</p><p><code>alarm_configs</code> is a YAML file which holds the desired configuration of the alarms that are required.
The default alarm config for this project can be found <a href="/Infrastructure-Playbook/module/default-config/windows-alarms.yml">here</a>.
New alarms can be either added to the default config if they are likely to be needed across all instances at Hackney, or the file can be copied, amended and provided as an optional value in the <code>alarm_configs</code> variable.</p><p>The current default is below:</p><p>YAML:</p><div class="mdxCodeBlock_1zKU"><div class="codeBlockContent_actS"><div tabindex="0" class="prism-code language-yaml codeBlock_tuNs thin-scrollbar"><div class="codeBlockLines_3uvA" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token punctuation" style="color:rgb(199, 146, 234)">---</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">cpu</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;CPU above 80% for 5 mins&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">comparison_operator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> GreaterThanOrEqualToThreshold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">metric_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CPUUtilization</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">evaluation_periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">2</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AWS/EC2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">360</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">statistic</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Average</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">threshold</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Reports where CPU is above 80% for 5 minutes&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">treat_missing_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> breaching</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dimensions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">ec2_status</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Instance status failure&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">comparison_operator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> GreaterThanOrEqualToThreshold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">metric_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> StatusCheckFailed_Instance</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">evaluation_periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> AWS/EC2</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">60</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">statistic</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Sum</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">threshold</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Reports whether the instance has passed both the instance status check and the system status check in the last minute.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">treat_missing_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> breaching</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dimensions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token punctuation" style="color:rgb(199, 146, 234)">[</span><span class="token punctuation" style="color:rgb(199, 146, 234)">]</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">free-space</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Free disk space less than 20%&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">comparison_operator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> LessThanThreshold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">metric_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Free_Space</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">evaluation_periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CWAgent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">3600</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">statistic</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Average</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">threshold</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">20</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Reports where free disk space is less than 20%.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">treat_missing_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> breaching</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dimensions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">objectname</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> LogicalDisk</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">instance</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;C:&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain" style="display:inline-block">
</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token key atrule">memory</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Memory usage above 80%&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">comparison_operator</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> GreaterThanThreshold</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">metric_name</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> RAM_USED</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">evaluation_periods</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">1</span><span class="token plain">  </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">namespace</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> CWAgent</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">period</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">300</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">statistic</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Average</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">threshold</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token number" style="color:rgb(247, 140, 108)">80</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">alarm_description</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> </span><span class="token string" style="color:rgb(195, 232, 141)">&quot;Reports where memory usage is above 80% for 5 mins.&quot;</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">treat_missing_data</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> breaching</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  </span><span class="token key atrule">dimensions</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">    </span><span class="token key atrule">objectname</span><span class="token punctuation" style="color:rgb(199, 146, 234)">:</span><span class="token plain"> Memory  </span></div></div></div><button type="button" aria-label="Copy code to clipboard" class="copyButton_2GIj">Copy</button></div></div><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="required-module-variables"></a>Required Module Variables<a class="hash-link" href="#required-module-variables" title="Direct link to heading">#</a></h3><p>See <code>01-inputs-required.tf</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="optional-module-variables"></a>Optional Module Variables<a class="hash-link" href="#optional-module-variables" title="Direct link to heading">#</a></h3><p>See <code>02-inputs-optional.tf</code></p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_prK2" id="module-output-variables"></a>Module Output Variables<a class="hash-link" href="#module-output-variables" title="Direct link to heading">#</a></h3><p>See <code>99-outputs.tf</code></p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/LBHackney-IT/Infrastructure-Playbook/edit/master/docs/terraform_ec2_monitoring.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" role="img" viewBox="0 0 40 40" class="iconEdit_2LL7"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav" aria-label="Blog list page navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/Infrastructure-Playbook/terraform_ec2"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« Creating an ec2 instance</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/Infrastructure-Playbook/certificates"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Certificate module Â»</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_2xL- thin-scrollbar"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#overview" class="table-of-contents__link">Overview</a></li><li><a href="#usage" class="table-of-contents__link">Usage</a></li><li><a href="#default-monitors-and-alerts" class="table-of-contents__link">Default monitors and alerts</a></li><li><a href="#custom-monitoring" class="table-of-contents__link">Custom monitoring</a><ul><li><a href="#required-module-variables" class="table-of-contents__link">Required Module Variables</a></li><li><a href="#optional-module-variables" class="table-of-contents__link">Optional Module Variables</a></li><li><a href="#module-output-variables" class="table-of-contents__link">Module Output Variables</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Made by HackIT.</div></div></div></footer></div>
<script src="/Infrastructure-Playbook/styles.72619473.js"></script>
<script src="/Infrastructure-Playbook/runtime~main.d9d6ccd6.js"></script>
<script src="/Infrastructure-Playbook/main.8f09436c.js"></script>
<script src="/Infrastructure-Playbook/1.c04c7cbc.js"></script>
<script src="/Infrastructure-Playbook/2.3728f161.js"></script>
<script src="/Infrastructure-Playbook/28.4cd0fd7b.js"></script>
<script src="/Infrastructure-Playbook/31.c0b947cf.js"></script>
<script src="/Infrastructure-Playbook/935f2afb.8d58e0da.js"></script>
<script src="/Infrastructure-Playbook/17896441.47489b2e.js"></script>
<script src="/Infrastructure-Playbook/af5ec72b.832e515d.js"></script>
</body>
</html>